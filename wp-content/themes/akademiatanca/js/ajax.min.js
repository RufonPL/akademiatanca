var AJAX={signup_form_proccess:function(){function g(){$(c).fadeIn(500),$(b).css({display:"block",opacity:"0"}).animate({opacity:1,top:"50%"},500),ga("send","event","Kursy","zapisz","Zapis na kurs", 1)}function h(){$(c).fadeOut(),$(b).animate({opacity:0,top:"40%"},500).fadeOut(),f.length=0,i(),$(a).css({overflow:"auto"})}function i(){$(".signuplogged").length||($("#sp_fullname").val(""),$("#sp_e_mail").val("")),$("#sp_phone").val(""),$("#sp_info").val(""),$("input.error").removeClass("error"),$("label.error").fadeOut()}var a=$("body, html"),b=$("#signup-popup"),c=$("#overlay"),d=$("#signup-popup .fa-close"),e=$(".signup-container .signup-btn"),f={};$(d).on("click",function(){h()}),$(c).on("click",function(){h()}),i(),$(e).on("click",function(){g(),$(a).css({overflow:"hidden"}),$("#signup-message").html("");var c=$(this).closest(".st-course").attr("data-course-name"),d=$(this).closest(".st-course").attr("data-course-type"),e=$(this).closest(".st-course").attr("data-course-level"),h=$(this).closest(".st-course").attr("data-course-level-id"),i=$(this).closest(".st-course").find(".stc-number").attr("data-stc-number"),j=$(this).closest(".st-course").find(".stc-date").attr("data-stc-start-date"),k=$(this).closest(".st-course").find(".stc-date").attr("data-stc-end-date"),l=$(this).closest(".st-course").find(".stc-place").attr("data-stc-place"),m=$(this).closest(".st-course").find(".stc-instructor").text(),n=$(this).closest(".st-course").find(".stc-instructor").attr("data-stc-instructor"),o=$(this).closest(".st-course").find(".stc-price").text(),p=$(this).closest(".st-course").find(".stc-price").attr("data-stc-pricelist"),q=$(this).closest(".st-course").find(".stc-daytime-days p"),r=$(this).closest(".st-course").find(".stc-daytime-times p"),s=[],t={};q.add(r).each(function(){var a=$(this);s.push(a.text())});for(var u=s.length,v=0;v<u/2;v++)t[s[v]]=s[v+u/2];course_type_text=d?" - "+d:"",course_level_text=e?", "+e:"",$(b).find(".course-name").text(c+course_type_text+course_level_text),$(b).find(".course-number").text(i),$(b).find(".course-price").text(o),f={action:"course_signup",course_name:c,course_type:d,course_level:e,course_level_id:h,course_no:i,course_start_date:j,course_end_date:k,course_place:l,course_instructor:m,course_instructor_id:n,course_price:o,course_pricelist:p,daystimes:JSON.stringify(t)},$(".payment-methods .p").on("click",function(){var a=$(this).find(".pm-radio");$(".pm-radio").removeClass("active"),$(a).addClass("active");var b=$(this).find(".active").closest(".p").find(".payment-method").text(),c="";"Przelew"==b&&(c=$(".bank-details").html()),f.payment_method=b,f.payment_info=c}),$(".payment-methods .p:first-child").trigger("click")}),$.validator.addMethod("phone_check",function(a,b){return this.optional(b)||/^[0-9 -]+$/i.test(a)},"incorrect phone no"),validator=$("#signupform2").validate({submitHandler:function(a){$("#sp-loader-container").fadeIn(700);var b=$("#sp_first_name").val(),c=$("#sp_last_name").val(),d=$("#sp_e_mail").val(),e=$("#sp_phone").val(),g=$("#sp_info").val(),h=$("#sp_source").val();f.source=h,f.client_first_name=b,f.client_last_name=c,f.client_email=d,f.client_phone=e,f.client_info=g;var j=f;return $.post(frontendajax.ajaxurl,j,function(a){setTimeout(function(){$("#sp-loader-container").fadeOut(100),i(),"success"==a?$("#signup-message").removeClass("message-error").addClass("message-success").html("<h6>Twoje zgłoszenie zostało przyjęte. Skontaktujemy się z Tobą</h6>"):"is-on-course"==a?$("#signup-message").removeClass("message-error").addClass("message-error").html("<h6>Jesteś już zapisany/a na ten kurs</h6>"):$("#signup-message").removeClass("message-success").addClass("message-error").html("<h6>Wystąpił błąd. Spróbuj ponownie lub skontaktuj się z nami</h6>")},1e3)}),!1},rules:{sp_first_name:{required:!0},sp_last_name:{required:!0},sp_rodo:{required:!0},sp_e_mail:{required:!0,email:!0}},messages:{sp_first_name:{required:"Podaj imię"},sp_last_name:{required:"Podaj nazwisko"},sp_e_mail:{required:"Podaj adres email",email:"Nieprawidłowy adres email"},sp_rodo:{required:"Zaakceptuj regulamin"}}})},home_form_proccess:function(){var a=$("#signupform"),b=$("#dance_category"),c=$("#dance_type"),d=$("#redirect-loader-overlay"),e=$("#type-loader");$(b).val("0"),$(b).on("change",function(){$(e).animate({opacity:1},300);var a=$("#dance_category option:selected").html();if(0!=$(this).val()){var d={action:"get_dances_by_category",url:$(b).val(),label:a};$.post(frontendajax.ajaxurl,d,function(a){$(e).animate({opacity:0},300),"success"==a[0]?($(c).closest(".select-box").removeClass("error"),$(c).html(a[1])):"no-dances"==a&&($(c).html('<option value="0">Brak tańców tej kategorii</option>'),$(c).closest(".select-box").addClass("error"))})}else $(e).animate({opacity:0},300),$(c).closest(".select-box").removeClass("error"),$(c).html('<option value="0">-- Wybierz dla kogo --</option>')}),$(a).submit(function(a){if(a.preventDefault(),0==$(b).val())$(b).closest(".select-box").addClass("error");else{$(b).closest(".select-box").removeClass("error");var e=$(b).val()+$(c).val();$(d).fadeIn(),ga("send","event","Kursy","zapisz","Zapis na kurs ze strony głównej", 1),setTimeout(function(){window.location.replace(e)},1500)}$(b).on("change",function(){0!=$(this).val()&&$(this).closest(".select-box").removeClass("error")})})},account_personal_data:function(){var a=$("<div></div>",{id:"mini-loader"}),b=$("<h5></h5>",{class:"medium text-center",text:"Twoje dane zostały zapisane",style:"color:#090"}),c=$("<h5></h5>",{class:"medium text-center",text:"Wystąpił błąd. Spróbuj ponownie lub skontaktuj się z nami",style:"color:#F00"}),d=$("#personal_submit");$(d).attr("disabled",!1),$.validator.addMethod("phone_check",function(a,b){return this.optional(b)||/^[0-9 -]+$/i.test(a)},"incorrect phone no");$("#personal_form").validate({submitHandler:function(e){var f=$("#personal_name").val(),g=$("#personal_email").val(),h=$("#personal_phone").val(),i={action:"account_personal_save",name:f,email:g,phone:h};return $(d).attr("disabled",!0),$(d).parent().append(a),$.post(frontendajax.ajaxurl,i,function(e){console.log(e),setTimeout(function(){$(d).attr("disabled",!1),$(a).remove(),"success"==e?($(b).fadeIn(),$("#personal_form").append(b),setTimeout(function(){$(b).fadeOut()},5e3)):($(c).fadeIn(),$("#personal_form").append(c),setTimeout(function(){$(c).fadeOut()},5e3))},1e3)}),!1},rules:{personal_name:{required:!0},personal_email:{required:!0,email:!0},personal_phone:{required:!0,phone_check:!0}},messages:{personal_name:{required:"Podaj imię i nazwisko"},personal_email:{required:"Podaj adres email",email:"Nieprawidłowy adres email"},personal_phone:{required:"Podaj nr telefonu",phone_check:"Nieprawidłowy nr telefonu"}}})},account_password:function(){function e(){var a=6;setInterval(function(){a--,a>=0&&$("#pass-changed").text("Zostaniesz wylogowany za: "+a+" sekund."),0===a&&(clearInterval(a),location.reload())},1e3)}var a=$("<div></div>",{id:"mini-loader"}),b=$("<h5></h5>",{class:"medium text-center",text:"Twoje hasło zostało zmienione",style:"color:#090"}),c=$("<h5></h5>",{class:"medium text-center",text:"Wystąpił błąd. Spróbuj ponownie lub skontaktuj się z nami",style:"color:#F00"}),d=$("#personal_pass_submit");$(d).attr("disabled",!1),$.validator.addMethod("pwcheck",function(a){return/^[A-Za-z0-9]*$/.test(a)&&/[a-z]/.test(a)&&/[A-Z]/.test(a)&&/\d/.test(a)});var f=$("#password_form").validate({submitHandler:function(g){var h=$("#personal_pass").val(),i=$("#personal_pass_repeat").val(),j=$("#personal_pass_current").val(),k={action:"account_new_password",pass:h,pass_repeat:i,pass_current:j};return $(d).attr("disabled",!0),$(d).parent().append(a),$.post(frontendajax.ajaxurl,k,function(g){console.log(g),setTimeout(function(){$(d).attr("disabled",!1),$(a).remove(),"success"==g?($(b).fadeIn(),$("#password_form").append(b),e()):"wrong-pass"==g?f.showErrors({personal_pass_current:"Nieprawidłowe hasło"}):($(c).fadeIn(),$("#password_form").append(c),setTimeout(function(){$(c).fadeOut()},5e3))},1e3)}),!1},rules:{personal_pass:{required:!0,pwcheck:!0,minlength:8},personal_pass_repeat:{equalTo:"#personal_pass"},personal_pass_current:{required:!0}},messages:{personal_pass:{required:"Podaj nowe hasło",pwcheck:"Hasło musi być alfanumeryczne i zawierać min. 1 małą i dużą literę oraz cyfrę",minlength:"Hasło jest zbyt krótkie"},personal_pass_repeat:{required:"Powtórz hasło",equalTo:"Hasła muszą być takie same"},personal_pass_current:{required:"Wpisz aktualne hasło"}}})},onDOMready:function(){this.signup_form_proccess(),this.home_form_proccess(),this.account_personal_data(),this.account_password()}};jQuery(document).ready(function(a){AJAX.onDOMready()});